const graphContainerSection=document.querySelector(".graph-div"),resizeObserver=new ResizeObserver(h=>{const{width:g,height:r}=h[0].contentRect;graphContainerSection.style.width=`${g*95/100}px`,graphContainerSection.style.height=`${r*92/100}px`,graphContainerSection.innerHTML=`
    <template id="graph-node-template">
        <svg xmlns="http://www.w3.org/2000/svg">
            <g class="node">
                <foreignObject class="test">
                    <span style="user-select: none"></span>
                </foreignObject>
            </g>
        </svg>
    </template>
    <div id="stars1"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>
    <div id="graph-container" style="width:100%;height:100%;background: radial-gradient(ellipse at bottom, #231C38 0%, #161224 100%);border-radius: ${g*5/100}px">
        <svg id="graph" xmlns="http://www.w3.org/2000/svg" style="width: 100%;height: 100%">
            <g id="mover">
                <g id="zoomer">
                </g>
            </g>
        </svg>
    </div>
`;const c=document.querySelector("#graph"),M=[["\u9AD8\u5B66\u5386",["\u5B66\u672F\u4EE3\u8868","\u535A\u58EB","\u7855\u58EB","\u540D\u6821\u6BD5\u4E1A","\u5B66\u4E1A\u4F18\u79C0"]],["\u7406\u79D1\u751F",["\u8BA1\u7B97\u673A\u79D1\u5B66","\u533B\u5B66","\u5DE5\u7A0B\u5B66","\u91D1\u878D","\u6570\u5B66\u4E13\u4E1A"]],["\u6587\u79D1\u751F",["\u8001\u5E08","\u6587\u827A\u9752\u5E74","\u6559\u80B2\u5DE5\u4F5C\u8005","\u533B\u62A4"]],["\u4E50\u89C2",["\u5E7D\u9ED8","\u7B11\u5BB9\u53EF\u63AC","\u8C41\u8FBE","\u9633\u5149","\u7231\u4EA4\u9645"]],["\u6709\u4E2A\u6027",["\u6781\u7B80\u4E3B\u4E49","\u5B89\u9759","\u51B7\u9759","\u6C89\u9ED8\u5BE1\u8A00","\u72EC\u7ACB\u601D\u8003"]],["\u5BB6\u5EAD\u8D23\u4EFB\u611F",["\u5B5D\u987A\u7236\u6BCD","\u5BB6\u5EAD\u548C\u7766","\u91CD\u89C6\u5BB6\u5EAD"]],["\u7231\u597D\u8FD0\u52A8",["\u5065\u8EAB","\u8DD1\u6B65","\u6E38\u6CF3","\u9A91\u884C","\u6ED1\u96EA","\u6781\u9650\u8FD0\u52A8"]],["\u7231\u597D\u97F3\u4E50",["\u5F39\u7434","\u5531\u6B4C","\u97F3\u4E50\u4F1A"]],["\u559C\u6B22\u65C5\u884C",["\u8FDC\u8DB3","\u8BF4\u8D70\u5C31\u8D70","\u81EA\u7531\u80CC\u5305\u5BA2","\u91CE\u5916\u9732\u8425","\u72EC\u81EA\u5192\u9669"]],["\u4E8B\u4E1A\u6709\u6210",["\u804C\u573A\u7CBE\u82F1","\u521B\u4E1A\u6210\u529F","\u6280\u672F\u4E13\u5BB6","\u793E\u4F1A\u5934\u8854"]],["\u76F8\u7231\u4E00\u751F",["\u76F8\u4E92\u966A\u4F34","\u5171\u540C\u6210\u957F","\u4E50\u4E8E\u6C9F\u901A"]],["\u793E\u4EA4\u8FBE\u4EBA",["\u5708\u5B50\u5E7F\u6CDB","\u5584\u4E8E\u8868\u8FBE","\u7231\u597D\u5E7F\u6CDB"]],["\u8D23\u4EFB\u5FC3\u5F3A",["\u505A\u4E8B\u6709\u8BA1\u5212","\u6267\u884C\u80FD\u529B\u5F3A","\u8BF4\u5230\u505A\u5230","\u4E0D\u4E71\u627F\u8BFA","\u601D\u8003\u5468\u5BC6"]],["\u70ED\u7231\u81EA\u7531",["\u8FFD\u6C42\u7CBE\u795E\u5BCC\u8DB3","\u72EC\u7ACB","\u4E0D\u88AB\u675F\u7F1A","\u4E0D\u5A5A\u4E3B\u4E49","\u4E01\u514B"]],["\u5065\u5EB7\u751F\u6D3B",["\u5E72\u996D\u4EBA","\u4F5C\u606F\u89C4\u5F8B","\u996E\u98DF\u5065\u5EB7","\u4FDD\u6301\u5065\u8EAB","\u7CBE\u529B\u5145\u6C9B"]],["\u6709\u7231\u5FC3",["\u70ED\u5FC3\u516C\u76CA\u4E8B\u4E1A","\u4E50\u4E8E\u52A9\u4EBA","\u5173\u7231\u52A8\u7269"]],["\u4F1A\u591A\u95E8\u8BED\u8A00",["\u6709\u8BED\u8A00\u5929\u8D4B","\u4E3B\u6D41\u8BED\u79CD","\u8DE8\u6587\u5316\u4EA4\u6D41","\u5C0F\u8BED\u79CD"]],["\u70ED\u7231\u827A\u672F",["\u6536\u85CF\u5BB6","\u827A\u672F\u521B\u4F5C\u8005","\u884C\u4E3A\u827A\u672F","\u827A\u672F\u5929\u8D4B"]],["\u79D1\u6280\u8FF7",["\u559C\u6B22\u519B\u4E8B","\u7231\u597D\u6570\u7801","\u9A6C\u65AF\u514B\u4FE1\u5F92","\u8FFD\u8E2A\u79D1\u6280\u6F6E\u6D41"]],["\u793E\u4F1A\u8D23\u4EFB\u5FC3",["\u5FD7\u613F\u8005","\u5173\u6CE8\u793E\u4F1A\u95EE\u9898","\u79EF\u6781\u53C2\u4E0E\u793E\u4F1A\u6D3B\u52A8"]],["\u70ED\u7231\u5B66\u4E60",["\u559C\u6B22\u4EA4\u6D41\u5206\u4EAB","\u6301\u7EED\u8FDB\u4FEE","\u4E50\u4E8E\u81EA\u6211\u63D0\u5347"]],["\u66FE\u521B\u8FC7\u4E1A",["\u8D22\u5BCC\u81EA\u7531","\u6709\u5546\u4E1A\u5934\u8111","\u4E00\u5FC3\u641E\u94B1","\u4E8B\u4E1A\u6210\u529F"]],["\u72EC\u7279\u54C1\u4F4D",["\u9AD8\u54C1\u8D28\u751F\u6D3B","\u5BF9\u751F\u6D3B\u6709\u5BA1\u7F8E\u8FFD\u6C42","\u5403\u559D\u8BB2\u7A76","\u53A8\u827A\u9AD8\u624B"]],["\u91CD\u89C6\u5F62\u8C61",["\u6F6E\u6D41\u65F6\u5C1A","\u7A7F\u642D\u6709\u54C1","\u5316\u5986\u6253\u626E","\u6CE8\u91CD\u536B\u751F"]],["\u6210\u719F\u7A33\u91CD",["\u51B7\u9759\u7406\u667A","\u901A\u60C5\u8FBE\u7406","\u575A\u97E7\u4E0D\u62D4"]],["\u6709\u597D\u5947\u5FC3",["\u559C\u6B22\u5C1D\u8BD5\u65B0\u4E8B\u7269","\u63A2\u7D22\u591A\u6587\u5316","\u4FDD\u6301\u5F00\u653E\u6001\u5EA6"]],["\u73AF\u4FDD\u4EBA\u58EB",["\u4FDD\u62A4\u73AF\u5883","\u73AF\u4FDD\u751F\u6D3B","\u7D20\u98DF\u4E3B\u4E49","\u5173\u6CE8\u73AF\u5883\u95EE\u9898"]],["\u5BA0\u7269\u5BB6\u4EBA",["\u732B\u54AA","\u72D7\u72D7","\u7279\u6B8A\u5BA0\u7269","\u5BF9\u5F85\u5BA0\u7269\u6E29\u67D4\u4F53\u8D34"]],["\u7535\u5F71\u8FF7",["\u7535\u5F71\u7F16\u5267","\u5F71\u8BC4\u5BB6","\u6B27\u7F8E\u5927\u7247","\u5C0F\u4F17\u51B7\u95E8"]],["\u6E38\u620F\u73A9\u5BB6",["\u7535\u5B50\u6E38\u620F","\u684C\u6E38","\u89D2\u8272\u626E\u6F14","\u624B\u6E38","\u6E38\u620F\u5F00\u53D1\u8005"]],["\u624B\u5DE5\u827A\u4EBA",["\u70D8\u7119\u7231\u597D","\u624B\u5DE5\u5236\u4F5C","DIY\u7231\u597D\u8005","\u523A\u7EE3","\u6728\u5DE5"]],["\u6444\u5F71\u7231\u597D\u8005",["\u98CE\u5149\u6444\u5F71","\u4EBA\u50CF\u6444\u5F71","\u5FAE\u8DDD\u6444\u5F71","\u7EAA\u5B9E\u6444\u5F71","\u6444\u5F71\u540E\u671F\u5904\u7406"]],["\u517B\u751F\u8FBE\u4EBA",["\u745C\u4F3D","\u4E2D\u533B","\u98DF\u7597","\u6C14\u529F","\u51A5\u60F3"]],["\u6210\u719F\u9B45\u529B",["\u81EA\u4FE1\u5E05\u6C14","\u8EAB\u59FF\u7EA4\u7EC6","\u5F3A\u58EE\u52C7\u731B","\u9AD8\u4E2A\u5B50180+"]]];{let z=function({svg:n,initNodes:t,clickCallback:o}){let l=d3.select(n).select("#zoomer").append("g").selectAll("g");const a=d3.forceSimulation().force("x",d3.forceX(m/2).strength(.002)).force("y",d3.forceY(k/2)).force("collide",d3.forceCollide().radius(s=>s.r+8)).force("charge",d3.forceManyBody().strength(30)).on("tick",()=>{l.attr("transform",s=>`translate(${s.x},${s.y})`)});function e(s,F){const O=new Map(l.data().map(f=>[f.id,f]));s=s.map(f=>Object.assign({},O.get(f.id)||f)),l=l.data(s,f=>f.id).join(f=>f.append($=>{const q=document.querySelector("#graph-node-template").content.firstElementChild.querySelector(".node").cloneNode(!0),d=q.querySelector("foreignObject"),R=id2Length($.id);return d.style.width=R,d.style.height=R,$.id.startsWith("b-")||(d.style.fontSize="0.9rem",d.style.borderRadius="50%",d.style.textAlign="center",d.style.lineHeight=R+"px",d.style.border="none",d.style.background="hsla(0, 0%, 30%, 0.1)",d.style.boxShadow="0 0 6px 0 #4d3779, inset 0 0 12px 0 #514273, inset 0 0 1px #ad8ee7",d.style.color="#BFC4C9",q.querySelector("span").textContent=$.id,F&&d3.select(d).attr("transform",`translate(${F.x-$.x}, ${F.y-$.y}) scale(0)`).transition().duration(1200).attr("transform","scale(1)")),q})).on("click",o).call(B(a)),a.nodes(s),a.alpha(.1).alphaDecay(.02).restart()}return e(t),e},B=function(n){function t(a,e){a.active||n.alphaTarget(.3).restart(),e.fx=e.x,e.fy=e.y}function o(a,e){console.log(`id=${e.id} fx=${e.fx.toFixed(0)}/${m.toFixed(0)} fy=${e.fy.toFixed(0)}/${k.toFixed(0)}`),e.fx=a.x,e.fy=a.y}function l(a,e){a.active||n.alphaTarget(0),e.fx=null,e.fy=null}return d3.drag().on("start",t).on("drag",o).on("end",l)},w=function(n){const{clientX:t,clientY:o}=n,l=t-N.x;x={x:C.x+l,y:C.y},x.x>A?x.x=A:x.x<P&&(x.x=P),H.style.transform=`translate(${x.x}px, ${x.y}px)`},X=function(n){let t,o;n.touches?(t=n.touches[0].clientX,o=n.touches[0].clientY):(t=n.clientX,o=n.clientY),N={x:t,y:o},c.addEventListener("mousemove",w),c.addEventListener("touchmove",w)},Y=function(n){C=x,c.removeEventListener("mousemove",w),c.removeEventListener("touchmove",w)};var b=z,S=B,E=w,i=X,p=Y;const u=new Map(M),y=["inset 0 0 60px #f298fa, inset 10px 0 46px #56a2d3, inset 80px 0 80px #4529ff, inset -20px -60px 100px #ffffff, inset 0 0 1px #fff, 0 0 6px #F8F8FFFF","inset 0 0 60px #abddf8, inset 10px 0 46px #56a2d3, inset 80px 0 80px #2e5fff, inset -20px -60px 100px #ffffff, inset 0 0 1px #fff, 0 0 6px #F8F8FFFF","inset 0 0 60px #b6baff, inset 10px 0 46px #b9ddf3, inset 80px 0 80px #006e80, inset -20px -60px 100px #ffffff, inset 0 0 1px #fff, 0 0 6px #F8F8FFFF"],{width:m,height:k}=document.querySelector("#graph").getBoundingClientRect(),{borders:D,offsetR:I,offsetL:j}=getBorders(m,k,100),L=[...u.keys()].map((n,t,o)=>{const a=Math.ceil(o.length/4),e=Math.floor(t/a),s=t%a;return{id:n,x:100+(Math.random()*.5+.5)*s*145,y:100+(Math.random()*.5+.5)*e*145,r:id2Length(n)/2+1}});L.push(...D);const v=new Map,T=z({svg:c,initNodes:L,clickCallback:(n,t)=>{const o=n.target.tagName==="SPAN"?n.target.parentNode:n.target;if(v.has(t.id)){v.get(t.id)?(o.style.background="hsla(0, 0%, 30%, 0.1)",o.style.boxShadow="0 0 6px 0 #4d3779, inset 0 0 12px 0 #514273, inset 0 0 1px #ad8ee7",v.set(t.id,!1)):(o.style.background="radial-gradient(circle at 75% 30%, white 5px, aqua 8%, #000041 60%, aqua 100%)",o.style.boxShadow=y[Math.floor(Math.random()*(y.length-1))],v.set(t.id,!0));return}v.set(t.id,!0),o.style.background="radial-gradient(circle at 75% 30%, white 5px, aqua 8%, #000041 60%, aqua 100%)",o.style.boxShadow=y[Math.floor(Math.random()*(y.length-1))];const l=u.get(t.id);if(l?.length){let a=360*Math.PI/(180*l.length),e=100;for(let s=0;s<l.length;s++){let F=t.x+e*Math.cos(a*s),O=t.y+e*Math.sin(a*s),f={id:l[s],x:F,y:O,r:id2Length(l[s])/2};L.push(f)}T(L,{x:t.x,y:t.y})}}}),H=document.querySelector("#mover");let N={x:0,y:0},x={x:0,y:0},C={x:0,y:0},P=j,A=I+j-100;c.addEventListener("mousedown",X),document.addEventListener("mouseup",Y),c.addEventListener("touchstart",X),document.addEventListener("touchend",Y)}});resizeObserver.observe(document.getElementById("graph-img"));function id2Length(h){return h.startsWith("b-")?100:h.length<5?90:100}function getBorders(h,g,r=100){const c=[],M=r/2;let b=Math.ceil(h/r*5/3);for(let i=0;i<b;i++){let p={id:`b-t${i}`,fx:M+i*r,fy:-r,r},u={id:`b-t${i}-`,fx:-p.fx,fy:-r,r},y={id:`b-b${i}`,fx:p.fx,fy:g,r},m={id:`b-b${i}-`,fx:-p.fx,fy:g,r};c.push(p,u,y,m)}let S=M+(b-1)*r*1.5,E=-S/2;b=Math.ceil(g/r)*2;for(let i=0;i<b;i++){let p={id:`b-r${i}`,fx:S,fy:i*r,r},u={id:`b-l${i}`,fx:E,fy:i*r,r};c.push(p,u)}return{borders:c,offsetR:S,offsetL:E}}
